{"paragraphs":[{"text":"import org.apache.spark.sql.SparkSession\nimport org.apache.spark.ml.feature.{StringIndexer, HashingTF, IDF, Tokenizer, NGram, StopWordsRemover}\nimport org.apache.spark.ml.Pipeline\nimport org.apache.spark.ml.classification.LogisticRegression\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nimport org.apache.spark.ml.tuning.{CrossValidator, ParamGridBuilder}\n","user":"anonymous","dateUpdated":"2017-05-25T16:39:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.sql.SparkSession\n\nimport org.apache.spark.ml.feature.{StringIndexer, HashingTF, IDF, Tokenizer, NGram, StopWordsRemover}\n\nimport org.apache.spark.ml.Pipeline\n\nimport org.apache.spark.ml.classification.LogisticRegression\n\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\n\nimport org.apache.spark.ml.tuning.{CrossValidator, ParamGridBuilder}\n"}]},"apps":[],"jobName":"paragraph_1495725507223_-1829176258","id":"20170525-151827_546078348","dateCreated":"2017-05-25T15:18:27+0000","dateStarted":"2017-05-25T16:39:47+0000","dateFinished":"2017-05-25T16:39:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7060"},{"text":"val spark = SparkSession.builder().getOrCreate()","user":"anonymous","dateUpdated":"2017-05-25T15:21:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@2d20b946\n"}]},"apps":[],"jobName":"paragraph_1495725525153_1424291089","id":"20170525-151845_950669302","dateCreated":"2017-05-25T15:18:45+0000","dateStarted":"2017-05-25T15:21:58+0000","dateFinished":"2017-05-25T15:21:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7061"},{"text":"val df = spark\n    .read\n    .option(\"inferSchema\", \"true\")\n    .option(\"delimiter\", \"\\t\")\n    .format(\"csv\")\n    .load(\"s3://whitney-dsi/SMSSpamCollection\")","user":"anonymous","dateUpdated":"2017-05-25T15:23:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndf: org.apache.spark.sql.DataFrame = [_c0: string, _c1: string]\n"}]},"apps":[],"jobName":"paragraph_1495725718091_-68441054","id":"20170525-152158_1642284078","dateCreated":"2017-05-25T15:21:58+0000","dateStarted":"2017-05-25T15:23:56+0000","dateFinished":"2017-05-25T15:24:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7062"},{"text":"df.show(3)","user":"anonymous","dateUpdated":"2017-05-25T15:24:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+--------------------+\n| _c0|                 _c1|\n+----+--------------------+\n| ham|Go until jurong p...|\n| ham|Ok lar... Joking ...|\n|spam|Free entry in 2 a...|\n+----+--------------------+\nonly showing top 3 rows\n\n"}]},"apps":[],"jobName":"paragraph_1495725836344_756996934","id":"20170525-152356_278445407","dateCreated":"2017-05-25T15:23:56+0000","dateStarted":"2017-05-25T15:24:11+0000","dateFinished":"2017-05-25T15:24:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7063"},{"text":"val indexer = new StringIndexer()\n    .setInputCol(\"_c0\")\n    .setOutputCol(\"label\")\n    .fit(df)","user":"anonymous","dateUpdated":"2017-05-25T15:30:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nindexer: org.apache.spark.ml.feature.StringIndexerModel = strIdx_6489e8baa03a\n"}]},"apps":[],"jobName":"paragraph_1495725851922_1975912098","id":"20170525-152411_1584244121","dateCreated":"2017-05-25T15:24:11+0000","dateStarted":"2017-05-25T15:30:14+0000","dateFinished":"2017-05-25T15:30:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7064"},{"text":"val tokenizer = new Tokenizer()\n    .setInputCol(\"_c1\")\n    .setOutputCol(\"words\")","user":"anonymous","dateUpdated":"2017-05-25T15:44:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ntokenizer: org.apache.spark.ml.feature.Tokenizer = tok_3caf8c8281b4\n"}]},"apps":[],"jobName":"paragraph_1495726176263_853844743","id":"20170525-152936_706546604","dateCreated":"2017-05-25T15:29:36+0000","dateStarted":"2017-05-25T15:44:27+0000","dateFinished":"2017-05-25T15:44:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7065"},{"text":"val remover = new StopWordsRemover()\n    .setInputCol(\"words\")\n    .setOutputCol(\"stopped_words\")","user":"anonymous","dateUpdated":"2017-05-25T15:46:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nremover: org.apache.spark.ml.feature.StopWordsRemover = stopWords_4423e752d799\n"}]},"apps":[],"jobName":"paragraph_1495727067109_-1691578480","id":"20170525-154427_1641680300","dateCreated":"2017-05-25T15:44:27+0000","dateStarted":"2017-05-25T15:46:35+0000","dateFinished":"2017-05-25T15:46:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7066"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1495732562444_530788054","id":"20170525-171602_1269274191","dateCreated":"2017-05-25T17:16:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8741","text":"val nGram = new NGram()\n    .setN(2)\n    .setInputCol(\"stopped_words\")\n    .setOutputCol(\"nGrams\")","dateUpdated":"2017-05-25T17:17:36+0000","dateFinished":"2017-05-25T17:17:36+0000","dateStarted":"2017-05-25T17:17:36+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nnGram: org.apache.spark.ml.feature.NGram = ngram_fbd5bd8e3f05\n"}]}},{"text":"val hashingTF = new HashingTF()\n    .setInputCol(\"nGrams\")\n    .setOutputCol(\"hashed\")","user":"anonymous","dateUpdated":"2017-05-25T17:18:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nhashingTF: org.apache.spark.ml.feature.HashingTF = hashingTF_508a0e3bec1b\n"}]},"apps":[],"jobName":"paragraph_1495727195108_1244222550","id":"20170525-154635_100784354","dateCreated":"2017-05-25T15:46:35+0000","dateStarted":"2017-05-25T17:18:10+0000","dateFinished":"2017-05-25T17:18:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7067"},{"text":"val idf = new IDF()\n    .setInputCol(\"hashed\")\n    .setOutputCol(\"features\")","user":"anonymous","dateUpdated":"2017-05-25T15:52:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nidf: org.apache.spark.ml.feature.IDF = idf_6bfc23d32d1d\n"}]},"apps":[],"jobName":"paragraph_1495727384664_-565207200","id":"20170525-154944_762896948","dateCreated":"2017-05-25T15:49:44+0000","dateStarted":"2017-05-25T15:52:41+0000","dateFinished":"2017-05-25T15:52:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7068"},{"text":"val lr = new LogisticRegression()","user":"anonymous","dateUpdated":"2017-05-25T15:55:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nlr: org.apache.spark.ml.classification.LogisticRegression = logreg_f203c4114c0f\n"}]},"apps":[],"jobName":"paragraph_1495727561586_104718901","id":"20170525-155241_1377780629","dateCreated":"2017-05-25T15:52:41+0000","dateStarted":"2017-05-25T15:55:50+0000","dateFinished":"2017-05-25T15:55:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7069"},{"text":"val Array(train, test) = df.randomSplit(Array(0.7,0.3), 2)","user":"anonymous","dateUpdated":"2017-05-25T16:01:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n\ntrain: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [_c0: string, _c1: string]\ntest: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [_c0: string, _c1: string]\n"}]},"apps":[],"jobName":"paragraph_1495728046825_-1919159360","id":"20170525-160046_1330632543","dateCreated":"2017-05-25T16:00:46+0000","dateStarted":"2017-05-25T16:01:40+0000","dateFinished":"2017-05-25T16:01:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7070"},{"text":"val pipeline = new Pipeline()\n    .setStages(Array(indexer,tokenizer, remover, nGram, hashingTF, idf, lr))","user":"anonymous","dateUpdated":"2017-05-25T17:18:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\npipeline: org.apache.spark.ml.Pipeline = pipeline_a1b5cb08d0f8\n"}]},"apps":[],"jobName":"paragraph_1495727750867_727884068","id":"20170525-155550_125328238","dateCreated":"2017-05-25T15:55:50+0000","dateStarted":"2017-05-25T17:18:42+0000","dateFinished":"2017-05-25T17:18:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7071"},{"text":"val model = pipeline.fit(train)","user":"anonymous","dateUpdated":"2017-05-25T17:18:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nmodel: org.apache.spark.ml.PipelineModel = pipeline_a1b5cb08d0f8\n"}]},"apps":[],"jobName":"paragraph_1495727837456_-816174564","id":"20170525-155717_1952413237","dateCreated":"2017-05-25T15:57:17+0000","dateStarted":"2017-05-25T17:18:47+0000","dateFinished":"2017-05-25T17:19:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7072"},{"text":"val predictions = model.transform(test)","user":"anonymous","dateUpdated":"2017-05-25T17:20:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\npredictions: org.apache.spark.sql.DataFrame = [_c0: string, _c1: string ... 9 more fields]\n"}]},"apps":[],"jobName":"paragraph_1495728283785_1400021784","id":"20170525-160443_606300273","dateCreated":"2017-05-25T16:04:43+0000","dateStarted":"2017-05-25T17:20:21+0000","dateFinished":"2017-05-25T17:20:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7073"},{"text":"val evaluator = new MulticlassClassificationEvaluator()\n    .setLabelCol(\"label\")\n    .setPredictionCol(\"prediction\")\n    .setMetricName(\"accuracy\")","user":"anonymous","dateUpdated":"2017-05-25T16:10:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nevaluator: org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator = mcEval_3b0c2ba08bcd\n"}]},"apps":[],"jobName":"paragraph_1495727880305_290960915","id":"20170525-155800_1724029016","dateCreated":"2017-05-25T15:58:00+0000","dateStarted":"2017-05-25T16:10:34+0000","dateFinished":"2017-05-25T16:10:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7074"},{"text":"evaluator.evaluate(predictions)","user":"anonymous","dateUpdated":"2017-05-25T17:20:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nres4: Double = 0.9349442379182156\n"}]},"apps":[],"jobName":"paragraph_1495728404839_526762729","id":"20170525-160644_1689995533","dateCreated":"2017-05-25T16:06:44+0000","dateStarted":"2017-05-25T17:20:24+0000","dateFinished":"2017-05-25T17:20:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7075"},{"text":"val params = new ParamGridBuilder()\n    .addGrid(lr.regParam, Array(0.1, 0.01))\n    .addGrid(idf.minDocFreq, Array(1,2,3))\n    .build()","user":"anonymous","dateUpdated":"2017-05-25T17:36:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1495728638987_-1750395800","id":"20170525-161038_1251721816","dateCreated":"2017-05-25T16:10:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7076","dateFinished":"2017-05-25T17:36:21+0000","dateStarted":"2017-05-25T17:36:21+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nparams: Array[org.apache.spark.ml.param.ParamMap] =\nArray({\n\tidf_6bfc23d32d1d-minDocFreq: 1,\n\tlogreg_f203c4114c0f-regParam: 0.1\n}, {\n\tidf_6bfc23d32d1d-minDocFreq: 2,\n\tlogreg_f203c4114c0f-regParam: 0.1\n}, {\n\tidf_6bfc23d32d1d-minDocFreq: 3,\n\tlogreg_f203c4114c0f-regParam: 0.1\n}, {\n\tidf_6bfc23d32d1d-minDocFreq: 1,\n\tlogreg_f203c4114c0f-regParam: 0.01\n}, {\n\tidf_6bfc23d32d1d-minDocFreq: 2,\n\tlogreg_f203c4114c0f-regParam: 0.01\n}, {\n\tidf_6bfc23d32d1d-minDocFreq: 3,\n\tlogreg_f203c4114c0f-regParam: 0.01\n})\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1495730573480_877380059","id":"20170525-164253_2015814894","dateCreated":"2017-05-25T16:42:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8276","text":"val cv = new CrossValidator()\n    .setEstimator(pipeline)\n    .setEstimatorParamMaps(params)\n    .setEvaluator(evaluator)\n    .setNumFolds(3)","dateUpdated":"2017-05-25T17:36:26+0000","dateFinished":"2017-05-25T17:36:27+0000","dateStarted":"2017-05-25T17:36:26+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ncv: org.apache.spark.ml.tuning.CrossValidator = cv_8e6c94210dcc\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1495730782095_1383587542","id":"20170525-164622_907767574","dateCreated":"2017-05-25T16:46:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8385","text":"val cvModel = cv.fit(train)","dateUpdated":"2017-05-25T17:36:30+0000","dateFinished":"2017-05-25T17:38:49+0000","dateStarted":"2017-05-25T17:36:30+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ncvModel: org.apache.spark.ml.tuning.CrossValidatorModel = cv_8e6c94210dcc\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1495730838119_-102035230","id":"20170525-164718_2052832315","dateCreated":"2017-05-25T16:47:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8484","text":"val predictions = cvModel.transform(test)","dateUpdated":"2017-05-25T17:36:37+0000","dateFinished":"2017-05-25T17:38:50+0000","dateStarted":"2017-05-25T17:36:37+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\npredictions: org.apache.spark.sql.DataFrame = [_c0: string, _c1: string ... 9 more fields]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1495731042648_-167367567","id":"20170525-165042_1052888563","dateCreated":"2017-05-25T16:50:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8558","text":"evaluator.evaluate(predictions)","dateUpdated":"2017-05-25T17:36:40+0000","dateFinished":"2017-05-25T17:38:51+0000","dateStarted":"2017-05-25T17:38:49+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nres5: Double = 0.942998760842627\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1495731066492_1770658615","id":"20170525-165106_2000366966","dateCreated":"2017-05-25T16:51:06+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8657"}],"name":"NLP","id":"2CHABJFDG","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}